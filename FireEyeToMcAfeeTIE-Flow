[
    {
        "id": "d8ccd887.dbce18",
        "type": "tab",
        "label": "FireEye To McAfee TIE",
        "disabled": false,
        "info": ""
    },
    {
        "id": "4f67736.28eff8c",
        "type": "dxl-core-event out",
        "z": "d8ccd887.dbce18",
        "name": "",
        "topic": "/vendor/fireeye",
        "client": "c6f8820a.ffd4d",
        "x": 840,
        "y": 200,
        "wires": []
    },
    {
        "id": "cdf986ea.414e48",
        "type": "dxl-tie-set-file-reputation",
        "z": "d8ccd887.dbce18",
        "name": "",
        "client": "52426a78.e99ff4",
        "trustLevel": "",
        "comment": "",
        "x": 850,
        "y": 600,
        "wires": [
            []
        ]
    },
    {
        "id": "a63f6113.7a05",
        "type": "inject",
        "z": "d8ccd887.dbce18",
        "name": "FIreEye Major",
        "topic": "",
        "payload": "{   \"product\": \"MAS\",   \"appliance-id\": \"00:00:00:00:00:00\",   \"appliance\": \"fireeye-000000\",   \"alert\": {     \"src\": {       \"url\": \"/data/share/winxp-sp3/src/41281428cd6f503f948e931d546e340c.exe\"     },     \"severity\": \"majr\",     \"alert-url\": \"https://fireeye-000000/malware_analysis/analyses?maid=146658\",     \"explanation\": {       \"malware-detected\": {         \"malware\": {           \"malicious\": \"yes\",           \"executed-at\": \"2017-05-09T14:30:25Z\",           \"md5sum\": \"41281428cd6f503f948e931d546e340c\",           \"type\": \"exe\",           \"name\": \"Trojan.LuminosityLink\"         }       }     },     \"occurred\": \"2017-05-09T14:30:25Z\",     \"action\": \"notified\",     \"id\": \"146658\",     \"name\": \"malware-object\"   },   \"version\": \"7.7.5.577562\",   \"msg\": \"concise\" }",
        "payloadType": "json",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 110,
        "y": 100,
        "wires": [
            [
                "6e121cd7.fc89fc"
            ]
        ]
    },
    {
        "id": "60e6321a.d30e5c",
        "type": "http in",
        "z": "d8ccd887.dbce18",
        "name": "",
        "url": "/fireeye",
        "method": "post",
        "upload": true,
        "swaggerDoc": "",
        "x": 88,
        "y": 229,
        "wires": [
            [
                "e6466db3.36f64"
            ]
        ]
    },
    {
        "id": "6e121cd7.fc89fc",
        "type": "json",
        "z": "d8ccd887.dbce18",
        "name": "",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 310,
        "y": 60,
        "wires": [
            [
                "f5c26108.fbdf4"
            ]
        ]
    },
    {
        "id": "22b54416.ed8ed4",
        "type": "dxl-core-event in",
        "z": "d8ccd887.dbce18",
        "name": "",
        "topic": "/vendor/fireeye",
        "client": "c6f8820a.ffd4d",
        "payloadType": "txt",
        "x": 120,
        "y": 360,
        "wires": [
            [
                "df8d1ac.eebd168"
            ]
        ]
    },
    {
        "id": "41503465.0cab54",
        "type": "change",
        "z": "d8ccd887.dbce18",
        "name": "Unknown",
        "rules": [
            {
                "t": "set",
                "p": "payload.mcafee-rep",
                "pt": "msg",
                "to": "$replace(\t   payload.alert.severity,\t   \"unkn\",\t   \"50\"\t)\t\t",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 540,
        "y": 160,
        "wires": [
            [
                "91409310.d9c6a",
                "4f67736.28eff8c"
            ]
        ]
    },
    {
        "id": "91409310.d9c6a",
        "type": "debug",
        "z": "d8ccd887.dbce18",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 830,
        "y": 140,
        "wires": []
    },
    {
        "id": "fee93710.52b85",
        "type": "inject",
        "z": "d8ccd887.dbce18",
        "name": "FireEye Unknown",
        "topic": "",
        "payload": "{   \"product\": \"MAS\",   \"appliance-id\": \"00:00:00:00:00:00\",   \"appliance\": \"fireeye-000000\",   \"alert\": {     \"src\": {       \"url\": \"/data/share/winxp-sp3/src/41281428cd6f503f948e931d546e340c.exe\"     },     \"severity\": \"unkn\",     \"alert-url\": \"https://fireeye-000000/malware_analysis/analyses?maid=146658\",     \"explanation\": {       \"malware-detected\": {         \"malware\": {           \"malicious\": \"yes\",           \"executed-at\": \"2017-05-09T14:30:25Z\",           \"md5sum\": \"41281428cd6f503f948e931d546e340c\",           \"type\": \"exe\",           \"name\": \"Trojan.LuminosityLink\"         }       }     },     \"occurred\": \"2017-05-09T14:30:25Z\",     \"action\": \"notified\",     \"id\": \"146658\",     \"name\": \"malware-object\"   },   \"version\": \"7.7.5.577562\",   \"msg\": \"concise\" }",
        "payloadType": "json",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 120,
        "y": 60,
        "wires": [
            [
                "6e121cd7.fc89fc"
            ]
        ]
    },
    {
        "id": "e6a01b2a.4aa928",
        "type": "inject",
        "z": "d8ccd887.dbce18",
        "name": "FireEye Minor",
        "topic": "",
        "payload": "{\"product\":\"MAS\",\"appliance-id\":\"00:00:00:00:00:00\",\"appliance\":\"fireeye-000000\",\"alert\":{\"src\":{\"url\":\"/data/share/winxp-sp3/src/41281428cd6f503f948e931d546e340c.exe\"},\"severity\":\"minr\",\"alert-url\":\"https://fireeye-000000/malware_analysis/analyses?maid=146658\",\"explanation\":{\"malware-detected\":{\"malware\":{\"malicious\":\"yes\",\"executed-at\":\"2017-05-09T14:30:25Z\",\"md5sum\":\"41281428cd6f503f948e931d546e340c\",\"type\":\"exe\",\"name\":\"Trojan.LuminosityLink\"}}},\"occurred\":\"2017-05-09T14:30:25Z\",\"action\":\"notified\",\"id\":\"146658\",\"name\":\"malware-object\"},\"version\":\"7.7.5.577562\",\"msg\":\"concise\"}",
        "payloadType": "json",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 110,
        "y": 140,
        "wires": [
            [
                "6e121cd7.fc89fc"
            ]
        ]
    },
    {
        "id": "91dc724c.d9d748",
        "type": "inject",
        "z": "d8ccd887.dbce18",
        "name": "Critical",
        "topic": "",
        "payload": "{\"product\":\"MAS\",\"appliance-id\":\"00:00:00:00:00:00\",\"appliance\":\"fireeye-000000\",\"alert\":{\"src\":{\"url\":\"/data/share/winxp-sp3/src/41281428cd6f503f948e931d546e340c.exe\"},\"severity\":\"crit\",\"alert-url\":\"https://fireeye-000000/malware_analysis/analyses?maid=146658\",\"explanation\":{\"malware-detected\":{\"malware\":{\"malicious\":\"yes\",\"executed-at\":\"2017-05-09T14:30:25Z\",\"md5sum\":\"41281428cd6f503f948e931d546e340c\",\"type\":\"exe\",\"name\":\"Trojan.LuminosityLink\"}}},\"occurred\":\"2017-05-09T14:30:25Z\",\"action\":\"notified\",\"id\":\"146658\",\"name\":\"malware-object\"},\"version\":\"7.7.5.577562\",\"msg\":\"concise\"}",
        "payloadType": "json",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 90,
        "y": 180,
        "wires": [
            [
                "6e121cd7.fc89fc"
            ]
        ]
    },
    {
        "id": "f5c26108.fbdf4",
        "type": "switch",
        "z": "d8ccd887.dbce18",
        "name": "FireEyeSeverity",
        "property": "payload.alert.severity",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "unkn",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "minr",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "majr",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "crit",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 4,
        "x": 510,
        "y": 50,
        "wires": [
            [
                "41503465.0cab54"
            ],
            [
                "4d52d95b.95fea"
            ],
            [
                "d079f6b2.a29e3"
            ],
            [
                "b3fe222a.133308"
            ]
        ]
    },
    {
        "id": "4d52d95b.95fea",
        "type": "change",
        "z": "d8ccd887.dbce18",
        "name": "might_be_malicious",
        "rules": [
            {
                "t": "set",
                "p": "payload.mcafee-rep",
                "pt": "msg",
                "to": "$replace(\t   payload.alert.severity,\t   \"minr\",\t   \"30\"\t)\t\t",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 580,
        "y": 200,
        "wires": [
            [
                "4f67736.28eff8c",
                "91409310.d9c6a"
            ]
        ]
    },
    {
        "id": "d079f6b2.a29e3",
        "type": "change",
        "z": "d8ccd887.dbce18",
        "name": "known_malicious",
        "rules": [
            {
                "t": "set",
                "p": "payload.mcafee-rep",
                "pt": "msg",
                "to": "$replace(\t   payload.alert.severity,\t   \"majr\",\t   \"1\"\t)\t\t",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 570,
        "y": 240,
        "wires": [
            [
                "4f67736.28eff8c",
                "91409310.d9c6a"
            ]
        ]
    },
    {
        "id": "b3fe222a.133308",
        "type": "change",
        "z": "d8ccd887.dbce18",
        "name": "known_malicious",
        "rules": [
            {
                "t": "set",
                "p": "payload.mcafee-rep",
                "pt": "msg",
                "to": "$replace(\t   payload.alert.severity,\t   \"crit\",\t   \"1\"\t)\t\t",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 570,
        "y": 280,
        "wires": [
            [
                "4f67736.28eff8c",
                "91409310.d9c6a"
            ]
        ]
    },
    {
        "id": "df8d1ac.eebd168",
        "type": "json",
        "z": "d8ccd887.dbce18",
        "name": "",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 290,
        "y": 360,
        "wires": [
            [
                "bd1254ed.c1113"
            ]
        ]
    },
    {
        "id": "4b87f714.08fff8",
        "type": "change",
        "z": "d8ccd887.dbce18",
        "name": "FileName",
        "rules": [
            {
                "t": "set",
                "p": "fileName",
                "pt": "msg",
                "to": "$lookup(msg.payload.alert.explanation, \"malware-detected\").malware.name",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 740,
        "y": 360,
        "wires": [
            [
                "f69b1433.866d58"
            ]
        ]
    },
    {
        "id": "f69b1433.866d58",
        "type": "change",
        "z": "d8ccd887.dbce18",
        "name": "Comment",
        "rules": [
            {
                "t": "set",
                "p": "comment",
                "pt": "msg",
                "to": "Reputation set via OpenDXL",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 640,
        "y": 440,
        "wires": [
            [
                "403390a4.8c7718",
                "cdf986ea.414e48"
            ]
        ]
    },
    {
        "id": "403390a4.8c7718",
        "type": "debug",
        "z": "d8ccd887.dbce18",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 810,
        "y": 540,
        "wires": []
    },
    {
        "id": "aaa8a425.478c28",
        "type": "change",
        "z": "d8ccd887.dbce18",
        "name": "TrustLevel",
        "rules": [
            {
                "t": "set",
                "p": "trustLevel",
                "pt": "msg",
                "to": "payload.mcafee-rep",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 590,
        "y": 360,
        "wires": [
            [
                "4b87f714.08fff8"
            ]
        ]
    },
    {
        "id": "bd1254ed.c1113",
        "type": "change",
        "z": "d8ccd887.dbce18",
        "name": "MD5 Hash",
        "rules": [
            {
                "t": "set",
                "p": "hashes",
                "pt": "msg",
                "to": "{\"md5\":$lookup(msg.payload.alert.explanation, \"malware-detected\").malware.md5sum}",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 430,
        "y": 360,
        "wires": [
            [
                "aaa8a425.478c28"
            ]
        ]
    },
    {
        "id": "7fe51fa1.1721c8",
        "type": "debug",
        "z": "d8ccd887.dbce18",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 358.5,
        "y": 317,
        "wires": []
    },
    {
        "id": "e6466db3.36f64",
        "type": "node-red-contrib-httpauth",
        "z": "d8ccd887.dbce18",
        "name": "FireEye Authentication",
        "file": "",
        "cred": "",
        "authType": "Basic",
        "realm": "",
        "username": "fireeye",
        "password": "fireeye",
        "hashed": false,
        "x": 191.5,
        "y": 272,
        "wires": [
            [
                "7fe51fa1.1721c8",
                "6e121cd7.fc89fc"
            ]
        ]
    },
    {
        "id": "c6f8820a.ffd4d",
        "type": "dxl-client",
        "z": "",
        "configFile": "/data/dxl/dxlclient.config",
        "name": "fireeye",
        "keepAliveInterval": "1800",
        "reconnectDelay": "1"
    },
    {
        "id": "52426a78.e99ff4",
        "type": "dxl-client",
        "z": "",
        "configFile": "/data/dxl/dxlclient.config",
        "name": "nodered",
        "keepAliveInterval": "1800",
        "reconnectDelay": "1"
    }
]
